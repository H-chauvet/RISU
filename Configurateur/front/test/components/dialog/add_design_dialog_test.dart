import 'dart:typed_data';

import 'package:file_picker/file_picker.dart';
import 'package:flutter/services.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:flutter/material.dart';
import 'package:flutter_gen/gen_l10n/app_localizations.dart';
import 'package:front/app_routes.dart';
import 'package:front/components/dialog/add_design_dialog.dart';
import 'package:front/services/theme_service.dart';
import 'package:go_router/go_router.dart';
import 'package:provider/provider.dart';

void main() {
  Future<void> blankFunction(bool a, {int? faceLoad, Uint8List? fileData}) {
    return Future<void>.value();
  }

  setUp(() async {
    final roboto = rootBundle.load('assets/roboto/Roboto-Medium.ttf');
    final fontLoader = FontLoader('Roboto')..addFont(roboto);
    await fontLoader.load();
  });

  testWidgets('test unfilled form', (WidgetTester tester) async {
    await tester.binding.setSurfaceSize(const Size(6000, 1080));
    tester.binding.window.devicePixelRatioTestValue = (2.625);

    var b = Uint8List.fromList(list);

    await tester.pumpWidget(
      MultiProvider(
        providers: [
          ChangeNotifierProvider<ThemeService>(
            create: (_) => ThemeService(),
          ),
        ],
        child: MaterialApp(
          theme: ThemeData(fontFamily: 'Roboto'),
          home: InheritedGoRouter(
            goRouter: AppRouter.router,
            child: AddDesignDialog(
              file: FilePickerResult(<PlatformFile>[
                PlatformFile(name: 'test', size: 0, bytes: b)
              ]),
              callback: blankFunction,
            ),
          ),
          localizationsDelegates: AppLocalizations.localizationsDelegates,
          supportedLocales: AppLocalizations.supportedLocales,
          locale: const Locale('fr'),
        ),
      ),
    );

    await tester.tap(find.text('Devant'));
    await tester.tap(find.text('Derrière'));
    await tester.tap(find.text('Gauche'));
    await tester.tap(find.text('Droite'));
    await tester.tap(find.text('Haut'));
    await tester.tap(find.text('Bas'));
    await tester.tap(find.text('Ajouter'));

    await tester.pump();

    expect(find.text('Ajouter un conteneur'), findsOneWidget);
    expect(find.text('Où souhaitez-vous ajouter ce design ?'), findsWidgets);
  });
}

const List<int> list = [
  137,
  80,
  78,
  71,
  13,
  10,
  26,
  10,
  0,
  0,
  0,
  13,
  73,
  72,
  68,
  82,
  0,
  0,
  0,
  27,
  0,
  0,
  0,
  25,
  8,
  6,
  0,
  0,
  0,
  192,
  28,
  85,
  94,
  0,
  0,
  0,
  9,
  112,
  72,
  89,
  115,
  0,
  0,
  11,
  19,
  0,
  0,
  11,
  19,
  1,
  0,
  154,
  156,
  24,
  0,
  0,
  0,
  1,
  115,
  82,
  71,
  66,
  0,
  174,
  206,
  28,
  233,
  0,
  0,
  0,
  4,
  103,
  65,
  77,
  65,
  0,
  0,
  177,
  143,
  11,
  252,
  97,
  5,
  0,
  0,
  2,
  53,
  73,
  68,
  65,
  84,
  120,
  1,
  197,
  150,
  49,
  110,
  34,
  49,
  20,
  134,
  189,
  209,
  214,
  176,
  219,
  131,
  180,
  53,
  92,
  0,
  168,
  178,
  13,
  208,
  37,
  13,
  212,
  137,
  224,
  2,
  112,
  1,
  56,
  1,
  92,
  0,
  164,
  244,
  92,
  0,
  104,
  82,
  194,
  5,
  160,
  77,
  1,
  7,
  8,
  92,
  96,
  242,
  190,
  23,
  158,
  101,
  143,
  152,
  36,
  69,
  32,
  150,
  158,
  156,
  207,
  120,
  230,
  249,
  253,
  191,
  237,
  137,
  115,
  206,
  37,
  23,
  140,
  23,
  137,
  103,
  137,
  63,
  18,
  238,
  215,
  105,
  240,
  210,
  237,
  85,
  226,
  225,
  198,
  93,
  167,
  81,
  217,
  193,
  39,
  43,
  20,
  10,
  110,
  183,
  219,
  185,
  205,
  102,
  227,
  90,
  173,
  150,
  235,
  116,
  58,
  202,
  4,
  76,
  100,
  113,
  175,
  215,
  83,
  94,
  173,
  86,
  17,
  207,
  231,
  115,
  229,
  106,
  181,
  170,
  57,
  126,
  167,
  151,
  112,
  60,
  30,
  117,
  66,
  177,
  88,
  244,
  99,
  112,
  216,
  210,
  188,
  221,
  110,
  221,
  225,
  112,
  112,
  185,
  92,
  46,
  226,
  115,
  205,
  27,
  90,
  169,
  84,
  46,
  185,
  89,
  110,
  35,
  207,
  242,
  249,
  188,
  202,
  25,
  74,
  251,
  157,
  236,
  43,
  147,
  193,
  68,
  228,
  73,
  196,
  179,
  68,
  244,
  78,
  196,
  51,
  101,
  2,
  38,
  178,
  88,
  60,
  82,
  22,
  207,
  34,
  22,
  207,
  148,
  197,
  51,
  173,
  44,
  242,
  140,
  205,
  129,
  222,
  179,
  217,
  76,
  87,
  212,
  104,
  52,
  116,
  28,
  166,
  97,
  250,
  57,
  158,
  78,
  167,
  234,
  53,
  243,
  241,
  211,
  184,
  84,
  42,
  105,
  79,
  92,
  221,
  51,
  95,
  25,
  59,
  169,
  86,
  171,
  105,
  191,
  92,
  46,
  181,
  255,
  106,
  101,
  139,
  197,
  66,
  87,
  95,
  175,
  215,
  213,
  247,
  44,
  142,
  146,
  113,
  62,
  24,
  28,
  14,
  135,
  202,
  244,
  97,
  27,
  141,
  70,
  103,
  153,
  30,
  249,
  153,
  143,
  252,
  253,
  126,
  223,
  237,
  247,
  123,
  237,
  203,
  229,
  178,
  107,
  183,
  219,
  122,
  6,
  125,
  50,
  146,
  48,
  128,
  111,
  172,
  156,
  100,
  76,
  12,
  43,
  177,
  195,
  153,
  102,
  243,
  72,
  108,
  136,
  42,
  97,
  30,
  139,
  248,
  17,
  207,
  110,
  66,
  25,
  41,
  151,
  107,
  42,
  148,
  149,
  176,
  150,
  197,
  118,
  115,
  240,
  108,
  200,
  120,
  10,
  219,
  109,
  20,
  121,
  198,
  143,
  108,
  10,
  202,
  134,
  209,
  156,
  134,
  254,
  230,
  1,
  109,
  189,
  94,
  107,
  159,
  254,
  189,
  219,
  237,
  170,
  103,
  198,
  36,
  199,
  10,
  230,
  219,
  21,
  167,
  101,
  202,
  203,
  147,
  193,
  96,
  144,
  72,
  50,
  207,
  118,
  120,
  109,
  78,
  22,
  51,
  23,
  230,
  217,
  144,
  57,
  204,
  176,
  84,
  166,
  50,
  94,
  211,
  179,
  135,
  232,
  227,
  57,
  153,
  76,
  84,
  66,
  219,
  210,
  38,
  147,
  49,
  178,
  176,
  219,
  108,
  158,
  49,
  187,
  14,
  153,
  240,
  28,
  25,
  141,
  177,
  4,
  25,
  199,
  227,
  49,
  124,
  31,
  121,
  246,
  217,
  33,
  110,
  54,
  155,
  250,
  50,
  142,
  8,
  201,
  120,
  57,
  207,
  241,
  98,
  198,
  153,
  111,
  223,
  69,
  187,
  238,
  56,
  30,
  167,
  228,
  127,
  35,
  25,
  185,
  124,
  79,
  151,
  166,
  215,
  252,
  43,
  108,
  30,
  73,
  21,
  31,
  241,
  221,
  53,
  61,
  187,
  197,
  179,
  23,
  137,
  127,
  166,
  53,
  95,
  88,
  110,
  4,
  228,
  97,
  43,
  135,
  158,
  165,
  61,
  52,
  78,
  123,
  104,
  140,
  172,
  156,
  49,
  198,
  229,
  38,
  249,
  143,
  103,
  143,
  238,
  253,
  223,
  45,
  213,
  153,
  36,
  97,
  111,
  227,
  159,
  245,
  188,
  156,
  23,
  219,
  115,
  198,
  252,
  205,
  2,
  194,
  246,
  116,
  65,
  249,
  188,
  140,
  111,
  137,
  177,
  161,
  166,
  74,
  172,
  133,
  11,
  0,
  0,
  0,
  0,
  73,
  69,
  78,
  68,
  174,
  66,
  96,
  130
];
